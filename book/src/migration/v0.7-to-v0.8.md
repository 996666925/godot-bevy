# Migration Guide: v0.7 to v0.8

This guide covers breaking changes and new features when upgrading from godot-bevy 0.7.x to 0.8.0.

## Table of Contents

- [GodotSignals Resource (Breaking Change)](#godotsignals-resource-breaking-change)

## GodotSignals Resource (Breaking Change)

### What Changed

In v0.8.0, the signal connection system has been significantly simplified and improved:

**New `GodotSignals` SystemParam**: Signal connections are now handled through a dedicated `GodotSignals` resource

### Migration Path

The main change is switching from the standalone `connect_godot_signal` function to the new `GodotSignals` SystemParam.

#### Before (v0.7.x)

```rust
use godot_bevy::prelude::*;

fn connect_signals(
    mut scene_tree: SceneTreeRef,
) {
    if let Some(root) = scene_tree.get().get_root() {
        if let Some(button) = root.try_get_node_as::<Button>("UI/MyButton") {
            let mut handle = GodotNodeHandle::from_instance_id(button.instance_id());
            // Old function signature required SceneTreeRef parameter
            connect_godot_signal(&mut handle, "pressed", &mut scene_tree);
        }
    }
}
```

#### After (v0.8.0)

```rust
use godot_bevy::prelude::*;

fn connect_signals(
    mut scene_tree: SceneTreeRef,
    signals: GodotSignals,  // ‚Üê New SystemParam
) {
    if let Some(root) = scene_tree.get().get_root() {
        if let Some(button) = root.try_get_node_as::<Button>("UI/MyButton") {
            let mut handle = GodotNodeHandle::from_instance_id(button.instance_id());
            // New simplified API
            signals.connect(&mut handle, "pressed");
        }
    }
}
```

### Breaking Changes

1. **Function signature changed**: `connect_godot_signal` no longer requires `SceneTreeRef` parameter
2. **New SystemParam required**: Add `GodotSignals` parameter to systems that connect signals
3. **Recommended API change**: Use `signals.connect()` instead of direct `connect_godot_signal()` calls


### Migration Checklist

- [ ] Add `GodotSignals` parameter to systems that connect signals
- [ ] Replace `connect_godot_signal(&mut handle, signal_name, &mut scene_tree)` with `signals.connect(&mut handle, signal_name)`
- [ ] Remove unused `SceneTreeRef` parameters if they were only used for signal connections
- [ ] Test that all signal connections work correctly with the new system

### Summary

The v0.8.0 signal system simplifies signal connections while improving performance. The main migration step is:

1. Add `GodotSignals` parameter to systems that connect signals
2. Replace `connect_godot_signal(&mut handle, signal, &mut scene_tree)` with `signals.connect(&mut handle, signal)`
3. Remove unused `SceneTreeRef` parameters

The signal event handling (`EventReader<GodotSignal>`) remains unchanged, so only the connection setup needs to be updated.
